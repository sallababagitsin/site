<!DOCTYPE html>  
<html lang="tr">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Starr Inc. - API Hizmetleri</title>  
    <link rel="icon" href="" type="image/x-icon">  
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">  
    <style>  
        /* Önceki CSS kodları buraya */  

        .popup {  
            display: none;  
            position: fixed;  
            top: 0;  
            left: 0;  
            width: 100%;  
            height: 100%;  
            background-color: rgba(0, 0, 0, 0.7);  
            z-index: 1000;  
        }  

        .popup-content {  
            background-color: var(--card-background);  
            margin: 10% auto;  
            padding: 20px;  
            width: 80%;  
            max-width: 600px;  
            border-radius: 12px;  
            position: relative;  
        }  

        .close {  
            color: #aaa;  
            float: right;  
            font-size: 28px;  
            font-weight: bold;  
            cursor: pointer;  
        }  

        .close:hover,  
        .close:focus {  
            color: #fff;  
            text-decoration: none;  
            cursor: pointer;  
        }  

        .code-section {  
            margin-top: 20px;  
            max-height: 300px;  
            overflow-y: auto;  
        }  

        .code-panel {  
            background-color: #2a2a2a;  
            padding: 10px;  
            border-radius: 5px;  
            margin-bottom: 10px;  
        }  

        .copy-btn {  
            background-color: var(--secondary-color);  
            color: white;  
            border: none;  
            padding: 5px 10px;  
            border-radius: 5px;  
            cursor: pointer;  
            margin-top: 5px;  
        }  
    </style>  
</head>  
<body>  
    <!-- Önceki HTML kodları buraya -->  

    <div class="container">  
        <div id="apiList"></div>  
    </div>  

    <div id="codePopup" class="popup">  
        <div class="popup-content">  
            <span class="close">&times;</span>  
            <h2 id="popupTitle"></h2>  
            <div class="code-section">  
                <h3>Discord.js</h3>  
                <div class="code-panel">  
                    <pre id="jsCode"></pre>  
                    <button class="copy-btn" onclick="copyCode('jsCode')">Kopyala</button>  
                </div>  
                <h3>Python</h3>  
                <div class="code-panel">  
                    <pre id="pythonCode"></pre>  
                    <button class="copy-btn" onclick="copyCode('pythonCode')">Kopyala</button>  
                </div>  
                <h3>BDFD</h3>  
                <div class="code-panel">  
                    <pre id="bdfdCode"></pre>  
                    <button class="copy-btn" onclick="copyCode('bdfdCode')">Kopyala</button>  
                </div>  
            </div>  
        </div>  
    </div>  

    <div id="parameterPopup" class="popup">  
        <div class="popup-content">  
            <span class="close">&times;</span>  
            <h2 id="parameterTitle"></h2>  
            <div id="parameterContent"></div>  
        </div>  
    </div>  

    <footer>  
        <p>&copy; 2024 - Starr Inc. - Tüm hakları saklıdır.</p>  
    </footer>  

    <script>  
        const apiList = document.getElementById('apiList');  
        const loader = document.getElementById('loader');  
        const progress = document.querySelector('.progress');  
        const codePopup = document.getElementById('codePopup');  
        const parameterPopup = document.getElementById('parameterPopup');  
        const closeButtons = document.getElementsByClassName('close');  

        let isAdmin = false;  

        function showLoader() {  
            loader.style.display = 'flex';  
            simulateLoading();  
        }  

        function hideLoader() {  
            loader.style.display = 'none';  
            progress.style.width = '0%';  
        }  

        function simulateLoading() {  
            let width = 0;  
            const interval = setInterval(() => {  
                if (width >= 100) {  
                    clearInterval(interval);  
                    hideLoader();  
                } else {  
                    width += 10;  
                    progress.style.width = width + '%';  
                }  
            }, 200);  
        }  

        async function loadAPIs() {  
            showLoader();  
            apiList.innerHTML = '<h2>API Listesi</h2>';  
            
            const response = await fetch('/api/apis');  
            const apiListData = await response.json();  

            apiListData.forEach((api, index) => {  
                const apiCard = document.createElement('div');  
                apiCard.className = 'api-card';  
                apiCard.innerHTML = `  
                    <h3 class="api-title">${api.name}</h3>  
                    <p class="api-description">${api.description}</p>  
                    <button class="btn" onclick="openApiUrl('${api.url}')">API'ye Git</button>  
                    <button class="btn" onclick="showCodeExamples('${api.name}', '${api.url}')">Kod Örnekleri</button>  
                    <button class="btn" onclick="showParameters('${api.name}', ${JSON.stringify(api.parameters)})">Parametreler</button>  
                    ${isAdmin ? `<button class="btn delete-btn" onclick="deleteAPI(${index})">Sil</button>` : ''}  
                `;  
                apiList.appendChild(apiCard);  
            });  

            hideLoader();  
        }  

        function openApiUrl(url) {  
            window.open(url, '_blank');  
        }  

        async function deleteAPI(index) {  
            await fetch(`/api/apis/${index}`, { method: 'DELETE' });  
            loadAPIs();  
        }  

        function showCodeExamples(apiName, apiUrl) {  
            document.getElementById('popupTitle').textContent = `${apiName} - Kod Örnekleri`;  
            document.getElementById('jsCode').textContent = generateJsCode(apiUrl);  
            document.getElementById('pythonCode').textContent = generatePythonCode(apiUrl);  
            document.getElementById('bdfdCode').textContent = generateBDFDCode(apiUrl);  
            codePopup.style.display = 'block';  
        }  

        function showParameters(apiName, parameters) {  
            document.getElementById('parameterTitle').textContent = `${apiName} - Parametreler`;  
            const parameterContent = document.getElementById('parameterContent');  
            parameterContent.innerHTML = '';  
            parameters.forEach(param => {  
                parameterContent.innerHTML += `  
                    <h3>${param.name}</h3>  
                    <p>${param.description}</p>  
                    <p>Tür: ${param.type}</p>  
                    <p>Zorunlu: ${param.required ? 'Evet' : 'Hayır'}</p>  
                    <hr>  
                `;  
            });  
            parameterPopup.style.display = 'block';  
        }  

        function generateJsCode(apiUrl) {  
            return `const fetch = require('node-fetch');  

async function fetchAPI() {  
    const response = await fetch('${apiUrl}');  
    const data = await response.json();  
    console.log(data);  
}  

fetchAPI();`;  
        }  

        function generatePythonCode(apiUrl) {  
            return `import requests  

response = requests.get('${apiUrl}')  
data = response.json()  
print(data)`;  
        }  

        function generateBDFDCode(apiUrl) {  
            return `$nomention  
$httpGet[${apiUrl}]  
$sendMessage[$httpResult]`;  
        }  

        function copyCode(elementId) {  
            const codeElement = document.getElementById(elementId);  
            const textArea = document.createElement('textarea');  
            textArea.value = codeElement.textContent;  
            document.body.appendChild(textArea);  
            textArea.select();  
            document.execCommand('copy');  
            document.body.removeChild(textArea);  
            alert('Kod kopyalandı!');  
        }  

        for (let i = 0; i < closeButtons.length; i++) {  
            closeButtons[i].onclick = function() {  
                codePopup.style.display = 'none';  
                parameterPopup.style.display = 'none';  
            }  
        }  

        window.onclick = function(event) {  
            if (event.target == codePopup) {  
                codePopup.style.display = 'none';  
            }  
            if (event.target == parameterPopup) {  
                parameterPopup.style.display = 'none';  
            }  
        }  

        window.onload = loadAPIs;  
    </script>  
</body>  
</html>
